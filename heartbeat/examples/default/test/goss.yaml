port:
  tcp:5066:
    listening: true
    ip:
    - '127.0.0.1'

mount:
  /usr/share/heartbeat/data:
    exists: true
  /run/docker.sock:
    exists: true
  /var/lib/docker/containers:
    exists: true
    opts:
      - ro
  /usr/share/heartbeat/heartbeat.yml:
    exists: true
    opts:
      - ro

user:
  heartbeat:
    exists: true
    uid: 1000
    gid: 1000

http:
  http://elasticsearch-master:9200/_cat/indices:
    status: 200
    timeout: 2000
    body:
      - 'heartbeat-7.4.1'

file:
  /usr/share/heartbeat/heartbeat.yml:
    exists: true
    contains:
      - 'add_kubernetes_metadata'
      - 'output.elasticsearch'
      - 'elasticsearch-master:9200'

command:
  cd /usr/share/heartbeat && heartbeat test output:
    exit-status: 0
    stdout:
      - 'elasticsearch: http://elasticsearch-master:9200'
      - 'version: 7.4.1'
